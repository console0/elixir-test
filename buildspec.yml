version: 0.2

env:
  variables:
    MIX_ENV: "prod"

phases:
  install:
    commands:
      - mix local.hex --force
      - mix deps.get
      - mix compile 
      - mix distillery.release
  pre_build:
    commands:
      - bin/build pre_build
  build:
    commands:
      - bin/build build
  post_build:
    commands:
      - bin/build post_build

artifacts:
  files:
    - distillery_example.tar.gz
    - appspec.yml
    - templates/infra.yml
    - templates/production.conf
    - bin/unpack
    - bin/stop
    - bin/migrate
    - bin/start
    - bin/healthz
  discard-paths: no
